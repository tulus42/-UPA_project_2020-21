\documentclass [11pt, a4paper]{article}

\usepackage[left=1.5cm, text={18cm, 25cm}, top = 2.5cm]{geometry}
\usepackage{times}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{float}
\usepackage[czech]{babel}
\usepackage{enumitem}
\usepackage{hyperref}
\setlength\parindent{0pt}

%\graphicspath{ {./images/} }
\begin{document}



% členovia tímu
\subsection*{Riešitelia:}
\setlist{nolistsep}
\begin{itemize}[noitemsep]
\item Sabína Gregušová (xgregu02)
\item Peter Hamran (xhamra00)
\item Adrián Tulušák (xtulus00)
\end{itemize}

\section{Úvod}

\section{Príprava dát}

Tento projekt sa zameriava na situáciu v Českej republike (dotazy A, B) a na situáciu v Éurópskej únii (dotaz C) od vypuknutia pandémie. Keďže sa jedná o stále aktuálne téma, existuje k nemu pomerne veľké množstvo dát. Podarilo sa nám získať dátové sady, ktoré sú dostačujúce pre zodpovedanie všetkých 3 dotazov. Jedná sa o:

\begin{itemize}
\item pre A: \href{https://onemocneni-aktualne.mzcr.cz/api/v2/covid-19/osoby.min.json }{COVID-19: Přehled osob s prokázanou nákazou dle hlášení krajských hygienických stanic (v2)}
\item pre B: \href{https://onemocneni-aktualne.mzcr.cz/api/v2/covid-19/kraj-okres-nakazeni-vyleceni-umrti.min.json}{COVID-19: Přehled epidemiologické situace dle hlášení krajských hygienických stanic podle okresu}
\item pre C: 
\end{itemize}

Tieto dátové sady obsahujú najpodstatnejšie informácie, no pre ich lepšiu prezentáciu boli vytvorené a pridané 2 dátové sady. Dotazy by bolo možné zodpovedať aj bez nich, no pridajú na finálnej zrozumiteľnosti. Jedná sa o:
\begin{itemize}
\item \texttt{countries.json} obsahuje unikátne skratky krajín a ich český ekvivalent
\item \texttt{nuts\_lau.json} obsahuje kódy NUTS (kraj) a LAU (okres) a ich český ekvivalent
\end{itemize} 

Všetky dátové sady sú importované pomocou príkazu \texttt{mongoimport}. Dátové sady A a B potrebujú formátovanie, aby sme naozaj pracovali s podstatnými dátami. Celý tento proces je automatizovaný pomocou skriptu \texttt{prepData.sh}, ktorý:
\begin{itemize}
\item Zmaže a vytvorí novú (čistú) databázu s názvom "corona"
\item Postupne stiahne, a ak je to potrebné aj naformátuje, dátové sady vo formáte JSON
\item Naimportuje každú dátovú sadu ako kolekciu; kolekcie sú pomenované podľa hlavnej dátovej sady (A, B, C) a novo pridané dátové sady sú pomenované ako countries a nuts\_lau
\end{itemize}

Samotnú úpravu, prípravu a  konvertovanie dát vykonáva skript \texttt{convertData.py}, ktorý sa spúšťa s Python verziou 3. Tento skript bol navrhnutý tak, aby bol ľahko modifikovateľný a rozšíriteľný a preto využíva objektové orientáciu. Na začiatku sa pripojí k NoSQL aj MySQL databázi. Následne vytvorí relačnú databázu v jazyku SQL - kód vytvorenia relačnej databáze sa nachádza v samostatnom súbore s názvom \texttt{Corona.sql}, ktorý je preparsovaný a vykonajú sa jednotlivé príkazy vrámci skriptu \texttt{convertData.py}. Toto riešenie zaisťuje, že samotný skript obsahuje minimum \uv{natvrdo} napísaných príkazov pre vytvorenie relačnej databáze.

Samotná relačná databáza obsahuje dokopy 6 tabuliek - 3 hlavné tabuľky pre zodpovedanie dotazov a 3 pomocné. Teoreticky by bolo možné použiť iba 3 hlavné tabuľky, ale mnohé dáta by boli redundantné a neviedlo by to k vhodnému návrhu, preto boli vytvorené pomocné tabuľky. Slová ako \texttt{district} a \texttt{region} sú často zameniteľné, no v celom tomto projekte je slovo \texttt{district} považované za okres a \texttt{region} za kraj.

\begin{figure}[H]
\begin{center}
\includegraphics[width=\linewidth]{relationalDatabase.png}
\caption{Schéma relačnej databázy}
\end{center}
\end{figure}

\end{document}